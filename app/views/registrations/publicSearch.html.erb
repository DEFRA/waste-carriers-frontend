<%= render 'shared/content_for_pages' %>

<% content_for :page_title, createTitle('.heading') %>

<main id="content" role="main" class="group"><article role="article" class="group">

<% if params[:error] %>
<div id="error_explanation" class="validation-summary">
  <h2><%= params[:error]%></h2>
</div>
<% end %>

<% if !notice.nil? %>
<div id="note_explanation" class="note-summary">
  <h1>Information</h1>
  <p><%= notice %></p>
 </div>
<% end %>

<h1><%= t '.heading' %></h1>


<form method="get" action="/registrations/search">
<div class="box" data-journey="waste-carriers-registration:search-register">
	<fieldset>
	<legend></legend>	
		<div class="form-group">
			<label for="q" class="form-label"><%= t '.search_label' %></label>
			<input id="q" name="q" type="text" value="<%= params[:q]%>" />
		</div>

			<label for="oneline" class="form-label"><%=t '.filterLabel'%></label>
			<span id="disLabel" for="distance"><%= t '.distance_label' %></span>

		<!-- 
		<div id="onelinewrapper">
			<label for="oneline" class="form-label"><%=t '.filterLabel'%></label>
			<div id="oneline">
			<span id="disLabel" for="distance"><%= t '.distance_label' %></span>
				<% defaultDistance='any'%>
				<% if !params[:distance].nil?
				defaultDistance=params[:distance] 
				end %>
				<%= select_tag :distance, options_for_select(Registration.distance_options_for_select, defaultDistance) %>
			<span id="postLabel" for="postcode"><%= t '.postcode_label' %></span>
		    <input id="postcode" name="postcode" size="10" value="<%= params[:postcode]%>" type="text" />

		-->

			
		    <div class='inline'>

        		 <label class="block-label" for="registration_searchRegister_ten_miles">
        		 <input type="radio" value="postcode" name="registration[searchRegister]" id="registration_searchRegister_ten_miles">
          		 10 Miles
        		 </label>
        		 <label class="block-label" for="registration_searchRegister_20_miles">
        		 <input type="radio" value="postcode" name="registration[searchRegister]" id="registration_searchRegister_20_miles">
          		 20 Miles
        		 </label>
        		 <label class="block-label" for="registration_searchRegister_30_miles">
        		 <input type="radio" value="postcode" name="registration[searchRegister]" id="registration_searchRegister_30_miles">
          		 30 Miles
        		 </label>

        	</div> 

        	<div class='form-group'>
        		 <span id="postLabel" for="postcode"><%= t '.postcode_label' %></span>
		    	 <input id="postcode" name="postcode" size="10" value="<%= params[:postcode]%>" 
		    	 type="text">
		    </div>
		</div>

		<div class="form-group">
		 <input type="submit" id="reg-search" class="button" value="<%= t '.search_button_label' %>" />
		</div>
	</fieldset>
</div>
</form>


<% if params[:q] && (notice.nil? && params[:error].nil?) %>
<div id="reg-search-result" style="">
<h2><%= t '.search_found', :count => @registrations.count, :carrier => t('.carrier').pluralize(@registrations.count) %></h2>
<p><%= t '.search_results', :initial => '1', :count => @registrations.count, :records => pluralize(@registrations.count, t('.record')) %></p>


<% if @registrations.count > 0 %>

<table class="search">
	<thead class="search-header">
		<tr>
			<th class="search-header-field" style="width:30%"><%= t '.companyName_table_heading' %></th>
			<th class="search-header-field" style="width:40%"><%= t '.address_table_heading' %></th>
			<th class="search-header-field" style="width:20%"><%= t '.regId_table_heading' %></th>
			<% if params[:distance]!='any' %><th class="search-header-field" style="width:10%"><%= t '.distance_table_heading' %></th><% end %>
		</tr>
	</thead>
	<tbody>
<% regCount = 1; %>
<% @registrations.each do |registration| %>
	<tr class="search-body<% if regCount.odd? %> solid-box<% else %> lighter-box<% end %>">
		<td class="search-body-field" style="width:30%"><%= registration.companyName %></td>
		<td class="search-body-field" style="width:40%"><%= format_address(registration) %></td>
		<td class="search-body-field" style="width:20%"><%= registration.regIdentifier %></td>
		<% if params[:distance]!='any' %><td class="search-body-field" style="width:10%"><%= registration.metaData.distance %> <%= t '.miles' %></td><% end %>
	</tr>
<% regCount = regCount + 1; %>
<% end %>

	</tbody>
</table>
<% end %>

</div>
<% end %>

<% if params[:q] %>
<p><a href="<%= Rails.configuration.waste_exemplar_end_url %>"><%= t '.feedback_link' %></a></p>
<% end %>

</article></main>

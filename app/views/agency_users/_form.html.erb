<%= form_for(@agency_user) do |f| %>

  <% if @agency_user.errors.any? %>
    <div id="error_explanation">
      <h2><%= t 'agencyUsers.errorHeading',:cause=>pluralize(@agency_user.errors.count, "error") %></h2>
      <ul>
      <% @agency_user.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group<% if @agency_user.errors[:email].any? %> validation<% end %>">
  	<%= validation_for(@agency_user, :email) %>
    <%= f.label :email, class: 'form-label' %>
    <%= f.text_field :email %>
  </div>
  
  <div class="form-group<% if @agency_user.errors[:password].any? %> validation<% end %>">
  	<%= validation_for(@agency_user, :password) %>
    <%= f.label :password, class: 'form-label' %>
    <%= f.password_field :password %>
  </div>
  
  <%
  isFinanceSuper = current_admin.has_role? :Role_financeSuper, Admin
  if isFinanceSuper
  %>
  <!-- Checkboxes representing roles -->
  <div class="form-group<% if @agency_user.errors[:roles].any? %> validation<% end %>">
    <%= validation_for(@agency_user, :roles) %>
  	<%= f.label :roles, class: 'form-label' %>
  	<p class='subtitle'><%= t 'agencyUsers.roleGuidance_1' %></p>
  	<p class='subtitle'><%= t 'agencyUsers.roleGuidance_2' %></p>
	<!--
	// Option A: Using a list of checkboxes
	<% Role.roles.each do |role| %>
		<div class=''>
        	<%= f.label t('agencyUsers.'+role), class: 'field-label' %>
        	<%= check_box_tag(role, 1, @agency_user.has_role?(role, AgencyUser)) %>
		</div>
	<% end %>
	-->

	<!-- 
	// Option B: Using a select box -->
	<%
	roleFound = nil
	Role.roles.each do |role|
		if @agency_user.has_role?(role, AgencyUser)
		  roleFound = role
		end
	end
	%>
	<select id="agency_user_roles" name="userRole">
	    <option>No role</option>
		<%= options_for_select(Role.translated_roles, roleFound) %>
	</select>
  </div>
  <% end %>
  
  <p class="action group">
    <input name="next" class="button" type="submit" value="<%if @agency_user.persisted?%><%=t 'agencyUsers.updateLabel'%><%else%><%=t 'agencyUsers.createLabel'%><%end%>"/>
  </p>
<% end %>